# 2 章 章末問題

## 2-1 マージソートに現れる小配列上の挿入ソート

> マージソートの最悪実行時間は $\Theta(n\lg n)$ 、挿入ソートの最悪実行時間は $\Theta(n^2)$ であるが、挿入ソートのほうが定数因子が小さいので、問題サイズが小さいときには挿入ソートのほうが多くの計算機上で高速に実行できる。そこで、部分問題が十分小さくなったときに、マージソートの中で挿入ソートを用いて再帰の**底を上げる**(coarsen the leaves)意義がある。 $n/k$ 個のそれぞれ長さ $k$ の部分リストを挿入ソートを用いてソートし、その後は標準的な方法でマージを行うようにマージソートを改良する。

### 2-1.a

> $n/k$ 個のそれぞれ長さ $k$ の部分リストは、挿入ソートにより最悪時に $\Theta(nk)$ 時間でソートできることを示せ。

挿入ソートの最悪実行時間は $an^2 + bn + c$ であるので

$$
  \frac{n}{k} \times (ak^2 + bk + c) = ank + bn + \frac{c}{k}n = \Theta(nk)
$$

### 2-1.b

> ソート済みの $n/k$ 個の部分リストは最悪時に $\Theta(n\lg (n/k))$ 時間でマージできることを示せ。

マージの最悪実行時間は $n + c$ であるので

$$
  \begin{split}
    \frac{n}{k} \times (k + c) + \frac{n}{2k} \times (2k + c) + \cdots + 2 \times (\frac{n}{2} + c)
      &= \lg \frac{n}{k} \times n + (\frac{cn}{k} + \frac{cn}{2k} + \cdots + 2c) \\
      &= \Theta(n\lg\frac{n}{k})
  \end{split}
$$

### 2-1.c

> 改良アルゴリズムの最悪実行時間を $\Theta(nk+n\lg (n/k))$ とする。改良アルゴリズムが標準的なマージソートと同じ漸近的実行時間を持つという条件の下で、 $k$ が取りうる最大値を $n$ の関数として $\Theta$ 記法で示せ。

？

### 2-1.d

> 実際的には $k$ の値をどのように選ぶべきか？

マージソートよりも挿入ソートの方が速い最大のサイズ。
