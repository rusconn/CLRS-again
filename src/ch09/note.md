# 9 章 中央値と順序統計量

$n$ 個の要素を持つ集合の $i$ 番目の**順序統計量**( $i$ th order statistic)はその集合の中で $i$ 番目に小さい要素のこと。  
最小値は $i = 1$ 、最大値は $i = n$ 。

$n$ 個の数の集合から $i$ 番目順序統計量を選択する問題を本章では考える。  
**選択問題**(selection problem)を正確に定義する。

**入力:** $n$ 個の（異なる）数の集合 $A$ と整数 $i$ ( $1 \le i \le n$ )  
**出力:** 正確に $i - 1$ 個の $A$ の要素より真に大きい要素 $x \in A$

選択問題はヒープソートやマージソートを使えば $O(n\lg n)$ 時間で解ける。  
本章ではもっと速いアルゴリズムを紹介する。

## 9.1 最大値と最小値

要素数 $n$ の集合の最小値を決定するために必要な比較回数を考える。  
まず $n - 1$ 回が上界であることが容易にわかる。  
集合中の各要素を検査し、これまでに発見した最小値を記憶すればよい。

```pseudo
MINIMUM(A):
  min = A[1]
  for i = 2 to A.length
    if min > A[i]
      min = A[i]
  return min
```

これが最良だろうか？答えはイエス。  
最小値以外は少なくとも１回は比較で"負ける"必要がある。  
これは比較回数の点で最適で、最大値についても同様に考えられる。

### 最小値と最大値を同時に求める方法

漸近的に最適な比較回数 $\Theta(n)$ で $n$ 個の要素の中から最小値と最大値の両方を簡単に発見できる。  
それぞれが $n - 1$ 回の比較で発見できるから、合わせて $2n - 2$ 回の比較となる。

しかし、これまでに発見した最小値と最大値の両方を保持すると $3 \lfloor n/2 \rfloor$ 回の比較で求めることができる。
入力要素の列を２要素の対に区切り、２要素のうち小さい方と大きい方を比較によって判明させる。  
その後、小さい方と暫定最小値、大きい方と暫定最大値を比較する。  
合計３回の比較によって、２要素を検査できたことになる。

## 9.2 線形期待時間選択アルゴリズム

一般の選択問題( $i$ 番目に小さい要素の発見)は最小値発見問題より難しそうだが、実は両問題とも漸近的な実行時間は $\Theta(n)$ 。

アルゴリズム $\text{RANDOMIZED-SELECT}$ はクイックソートを手本とする。

```pseudo
RANDOMIZED-SELECT(A, p, r, i):
  if p == r
    return A[p]
  q = RANDOMIZED-PARTITION(A, p, r)
  k = q - p + 1
  if i == k // ピボット値が答
    return A[q]
  else if i < k
    return RANDOMIZED-SELECT(A, p, q - 1, i)
  else
    return RANDOMIZED-SELECT(A, q + 1, r, i - k)
```

クイックソートと違い、分割の一方のみに再帰する。  
探したい要素が存在する方の分割のみ探すということ。

要素がすべて異なるならば、 $\text{RANDOMIZED-SELECT}$ の期待実行時間は $\Theta(n)$ で抑えられる。

[← 前へ](../ch08/note.md)
