# 3 章 関数の増加

## 3.1 漸近記法

### 漸近記法、関数、実行時間

漸近記法を適用する対象は関数。  
挿入ソートの最悪実行時間はある定数 $a,b,c$ を用いて $an^2+bn+c$ と記述できたが、詳細を捨て去って $\Theta(n^2)$ と書いた。  
この例では $\Theta(n^2)$ によって表現されているものは関数 $an^2+bn+c$ 。

アルゴリズムの実行時間に対して漸近記法を適用する場合、**どの**実行時間のことを考えているのか明確に理解している必要がある。  
最悪実行時間や、すべての入力に対する実行時間等。

### $\Theta$ 記法 ( $\Theta$ -notation)

ある与えられた関数 $g(n)$ に対して、 $\Theta(g(n))$ を**関数の集合**

$$
  \Theta(g(n)) = \lbrace f(n)\colon \text{ ある整数の定数 } c_1,c_2,n_0 \text{ が存在して、すべての } n \ge n_0 \text{ に対して } 0 \le c_1g(n) \le f(n) \le c_2g(n) \text{ を満たす } \rbrace
$$

と定義する。 $\Theta(g(n))$ が集合だから、 $f(n)$ が $\Theta(g(n))$ の要素であることは「 $f(n) \in \Theta(g(n))$ 」と表現できる。  
しかし本書では「 $f(n) = \Theta(g(n))$ 」と書くことにする。

$f(n) = \Theta(g(n))$ となる $f(n)$ と $g(n)$ は、すべての $n \ge n_0$ に対して、関数 $f(n)$ は定数倍の範囲で $g(n)$ と等しい。  
このとき、 $g(n)$ は $f(n)$ の**漸近的にタイトな限界**(asymptotically tight bound) であるという。

$\Theta(g(n))$ の定義はそのすべての要素 $f \in \Theta(g(n))$ が**漸近的に非負**(asymptotically nonnegative)であることを要請する。  
すなわち、 $n$ が十分に大きいとき、関数 $f(n)$ は非負でなければならない。  
したがって、関数 $g(n)$ 自体も漸近的に非負でなければならない。

第２章では、低次の項を捨て去り、最高次の項の係数を無視するという、厳密ではない方法で $\Theta$ 記法の概念を導入した。  
ここでは、形式的に $\frac{1}{2}n^2 - 3n = \Theta(n^2)$ を示すことで、この直観を正当化する。  
このために、すべての $n \ge n_0$ に対して

$$
  c_1n^2 \le \frac{1}{2}n^2 - 3n \le c_2n^2
$$

を満たすある正定数 $c_1,c_2,n_0$ を決定する。 $n^2$ で割ると

$$
  c_1 \le \frac{1}{2} - \frac{3}{n} \le c_2
$$

を得る。任意に定数 $c_2 \ge \frac{1}{2}$ を選択すると、右辺の不等号がすべての $n \ge 1$ に対して成立する。  
同様に、任意に定数 $c_1 \le \frac{1}{14}$ を選択すると、左辺の不等号がすべての $n \ge 7$ に対して成立する。  
したがって、 $c_1 = \frac{1}{14}, c_2 = \frac{1}{2}, n_0 = 7$ と取ると $\frac{1}{2}n^2 - 3n = \Theta(n^2)$ であることが分かる。

形式的な定義を用いると $6n^3 \ne \Theta(n^2)$ も証明できる。  
矛盾を導くために、すべての $n \ge n_0$ に対して $6n^3 \le c_2n^2$ を満たす定数 $c_2$ と $n_0$ が存在すると仮定する。  
しかし、 $6n^2$ で両辺を割ると $n \le \frac{c_2}{6}$ であるが、 $c_2$ は定数だからこの不等式を満足しない（十分に大きい） $n$ が存在する。

直観的には、漸近的に正の関数の低次の項は大きい $n$ に対して重要ではないから、漸近的にタイトな限界を決める際には無視できる。  
また $n$ が大きいときには、高次の項はその係数が非常に小さくても低次項を十分に支配できる。  
したがって、最高次の項の係数より少し小さい値に $c_1$ を設定し、少し大きな値に $c_2$ を設定すると、 $\Theta$ 記法を定義する不等式が成立する。

一般に、 $a_i$ が定数で $a_d > 0$ である任意の多項式

$$
  p(n) = \sum_{i=0}^{d}a_in^i
$$

に対して、 $p(n) = \Theta(n^d)$ が成立する。

任意の定数は $0$ 次の多項式であるから、任意の定数関数を $\Theta(n^0)$ または $\Theta(1)$ と表現できる。

### $O$ 記法 ( $O$-notation)

$\Theta$ 記法は関数を漸近的に上下から限定する。  
**漸近的上界**(asymptotic upper bound)だけに関心があるときは $O$ 記法を用いる。  
与えられた関数 $g(n)$ に対して、 $O(g(n))$ （“ビッグオー $g(n)$”あるいは単に“オー $g(n)$”と発音する）によって関数の集合

$$
  O(g(n)) = \lbrace f(n)\colon \text{ ある正の定数 } c,n_0 \text{ が存在して、すべての } n \ge n_0 \text{ に対して } 0 \le f(n) \le cg(n) \text{ を満たす } \rbrace
$$

を表現する。定数係数の範囲内で関数の上界を与えるのに $O$ 記法を用いる。

関数 $f(n)$ が集合 $O(g(n))$ の要素であるとき $f(n) = O(g(n))$ と書く。  
$\Theta$ 記法は $O$ 記法より強力な概念だから、 $f(n) = \Theta(g(n))$ ならば $f(n) = O(g(n))$ である。

$O$ 記法を用いると、アルゴリズムの全体的な構造を調べるだけでアルゴリズムの実行時間を記述できることが多い。  
たとえば、第２章で述べた挿入ソーティングアルゴリズムの二重ループ構造から直ちに最悪実行時間の上界 $O(n^2)$ が導かれる。  
すなわち、内側のループのコストは上から $O(1)$ で抑えられ、ループ制御変数 $i$ と $j$ の値は共に高々 $n$ だから、  
内側のループは $i$ と $j$ の値の $n^2$ 個の対のそれぞれに対して高々１回実行される。

「実行時間が $O(n^2)$ である」と言うとき、最悪実行時間が $O(n^2)$ であることを意味する。

### $\Omega$ 記法 ( $\Omega$-notation)

$O$ 記法が関数の漸近的**上界**を与えるのに対し、 $\Omega$ 記法は**漸近的下界**(asymptotic lower bound)を与える。  
与えられた関数 $g(n)$ に対して、 $\Omega(g(n))$ （“ビッグオメガ $g(n)$”あるいは単に“オメガ $g(n)$”と発音する）によって関数の集合

$$
  \Omega(g(n)) = \lbrace f(n)\colon \text{ ある正の定数 } c,n_0 \text{ が存在して、すべての } n \ge n_0 \text{ に対して } 0 \le cg(n) \le f(n) \text{ を満たす } \rbrace
$$

を表現する。

これまでの漸近記法の定義から、次の重要な定理が容易に証明できる。

**定理 3.1**　任意の２つの関数 $f(n)$ と $g(n)$ に対して、 $f(n) = \Theta(g(n))$ であるための必要十分条件は $f(n) = O(g(n))$ かつ $f(n) = \Omega(g(n))$ である。

（修飾なしに）「アルゴリズムの**実行時間**が $\Omega(g(n))$ である」と言うとき、アルゴリズムの最良実行時間の下界を与えている。  
たとえば、挿入ソートの最良実行時間は $\Omega(n)$ であり、したがって、挿入ソートの実行時間は $\Omega(n)$ である。

### 等式及び不等式における漸近記法

一般に漸近記法が式中に現れるときには、等号をその名前には関心がないある無名の関数を意味するものと解釈する。  
たとえば、式 $2n^2 + 3n + 1 = 2n^2 + \Theta(n)$ は $2n^2 + 3n + 1 = 2n^2 + f(n)$ を意味する。  
ここで、 $f(n)$ は集合 $\Theta(n)$ に属するある関数である。  
この例では $f(n) = 3n + 1$ であり、 $f(n)$ は実際に $\Theta(n)$ に属する。

このような漸近記法の使用法が、等式の本質的でない細かな部分や、雑多な部分を取り除く手助けになる。  
たとえば、第２章でマージソートの最悪実行時間を漸化式

$$
  T(n) = 2T(\frac{n}{2}) + \Theta(n)
$$

と表現した。もし $T(n)$ の漸近的振舞いだけに関心があるなら、すべての低次の項を正確に指定しても仕方がなく、  
すべて $\Theta(n)$ という項で記される無名の関数に含まれると理解する。

式中の無名の関数の個数は漸近記法が現れる回数に等しい。たとえば、式

$$
  \sum_{i=1}^{n}O(i)
$$

には（ $i$ の関数である）無名の関数が１つだけ存在する。

$$
  2n^2 + \Theta(n) = \Theta(n^2)
$$

のように漸近記法が等式の左辺に現れることがある。  
このとき、次の規則を用いて等式を解釈する。  
**等号の左辺でどのように無名の関数を選んでも、等号の右辺で等式を成立させるように無名の関数を選ぶ方法がある**。  
したがってこの式は、**任意の**関数 $f(n) \in \Theta(n)$ に対して**ある**関数 $g(n) \in \Theta(n^2)$ が存在して、  
すべての $n$ について $2n^2 + f(n) = g(n)$ が成立することを意味する。  
言い換えると、等式の右辺は左辺より詳細のレベルが粗い。

### $o$ 記法 ( $o$-notation)

$O$ 記法が与える漸近的上界は常に漸近的にタイトであるとは限らない。  
限界 $2n^2 = O(n^2)$ は漸近的にタイトであるが、限界 $2n = O(n^2)$ はタイトではない。  
漸近的にタイトでない上界を表すのに $o$ 記法を用いる。  
形式的には、 $o(g(n))$（“リトルオー $g(n)$”と発音する）を関数の集合

$$
  o(g(n)) = \lbrace f(n)\colon \text{ 任意の正の定数 } c > 0 \text{ に対して、ある正の定数 } n_0 > 0 \text{ が存在して、すべての } n \ge n_0 \text{ に対して } 0 \le f(n) \lt cg(n) \text{ を満たす } \rbrace
$$

と定義する。たとえば、 $2n = o(n^2)$ かつ $2n^2 \ne o(n^2)$ である。

$O$ 記法と $o$ 記法の定義は似ている。  
主な相違は、 $f(n) = O(g(n))$ では上界 $0 \le f(n) \le cg(n)$ が**ある**定数 $c > 0$ に対して成立するが、  
$f(n) = o(g(n))$ では、上界 $0 \le f(n) < cg(n)$ が**すべて**の定数 $c > 0$ に対して成立することである。  
直観的には、 $o$ 記法では、 $n$ が無限大に近づくにつれて関数 $f(n)$ は $g(n)$ に対して相対的に無限小に近づく。すなわち

$$
  \lim_{n \to \infty}\frac{f(n)}{g(n)} = 0
$$

が成立する。

### $\omega$ 記法 ( $\omega$-notation)

$\omega$ 記法と $\Omega$ 記法の関係は $o$ 記法と $O$ 記法との関係に等しい。  
漸近的にタイトでない下界を表すのに $\omega$ 記法を用いる。 $\omega$ 記法を

$$
  f(n) \in \omega(g(n)) \text{ のとき、かつそのときに限り} g(n) \in o(f(n))
$$

と定義することもできる。しかし、形式的には $\omega(g(n))$（“リトルオメガ $g(n)$”と発音する）を関数の集合

$$
  \omega(g(n)) = \lbrace f(n)\colon \text{ 任意の正の定数 } c > 0 \text{ に対して、ある正の定数 } n_0 > 0 \text{ が存在して、すべての } n \ge n_0 \text{ に対して } 0 \le cg(n) \lt f(n) \text{ を満たす } \rbrace
$$

と定義する。たとえば、 $\frac{n^2}{2} = \omega(n)$ かつ $\frac{n^2}{2} \ne \omega(n^2)$ である。関係 $f(n) = \omega(g(n))$ は、極限が存在する場合には

$$
  \lim_{n \to \infty}\frac{f(n)}{g(n)} = \infty
$$

を意味する。

### 関数の比較

$f(n)$ と $g(n)$ が漸近的に正である場合、以下の性質がある。

#### 推移性

- $f(n) = \Theta(g(n))$ かつ $g(n) = \Theta(h(n))$ ならば、 $f(n) = \Theta(h(n))$
- $f(n) = O(g(n))$ かつ $g(n) = O(h(n))$ ならば、 $f(n) = O(h(n))$
- $f(n) = \Omega(g(n))$ かつ $g(n) = \Omega(h(n))$ ならば、 $f(n) = \Omega(h(n))$
- $f(n) = o(g(n))$ かつ $g(n) = o(h(n))$ ならば、 $f(n) = o(h(n))$
- $f(n) = \omega(g(n))$ かつ $g(n) = \omega(h(n))$ ならば、 $f(n) = \omega(h(n))$

#### 反射性

- $f(n) = \Theta(f(n))$
- $f(n) = O(f(n))$
- $f(n) = \Omega(f(n))$

#### 対称性

- $f(n) = \Theta(g(n))$ のとき、かつそのときに限り $g(n) = \Theta(f(n))$

#### 転置対称性

- $f(n) = O(g(n))$ のとき、かつそのときに限り $g(n) = \Omega(f(n))$
- $f(n) = o(g(n))$ のとき、かつそのときに限り $g(n) = \omega(f(n))$

関数 $f$ と $g$ の漸近的比較と実数 $a$ と $b$ の比較に類似性が見出せる。

- $f(n) = O(g(n))$ は $a \le b$ と似ている
- $f(n) = \Omega(g(n))$ は $a \ge b$ と似ている
- $f(n) = \Theta(g(n))$ は $a = b$ と似ている
- $f(n) = o(g(n))$ は $a \lt b$ と似ている
- $f(n) = \omega(g(n))$ は $a \gt b$ と似ている

$f(n) = o(g(n))$ のとき、 $f(n)$ は $g(n)$ より**漸近的に小さい**(asymptotically smaller)という。  
$f(n) = \omega(g(n))$ のとき、 $f(n)$ は $g(n)$ より**漸近的に大きい**(asymptotically larger)という。

しかし、実数に関する**３分律**は漸近記法では成立しない。  
すなわち、 $f(n) = O(g(n))$ も $f(n) = \Omega(g(n))$ も共に成立しない関数 $f(n)$ と $g(n)$ が存在する。  
たとえば、 $n$ と $n^{1+\sin n}$ 等。

[← 前へ](../ch02/note.md)
