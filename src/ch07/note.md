# 7 章 クイックソート

クイックソートは実際によく使われるソート。  
期待実行時間が $\Theta(n\lg n)$ であり、定数コストも小さく高速。  
しかし内容は複雑で、最悪実行時間は $\Theta(n^2)$ 。

## 7.1 クイックソートの記述

マージソートと同様、クイックソートは第 $2.3.1$ 項で導入した分割統治法に基づいている。

- **分割:** $A[p..r]$ を $A[p..q-1]$ と $A[q+1..r]$ に分割する。  
  前者はどの要素も $A[q]$ 以下、後者はどの要素も $A[q]$ 以上となるようにする。空になることもある。  
  添字 $q$ はこの分割手続きの中で計算する。

- **統治:** $A[p..q-1]$ と $A[q+1..r]$ をクイックソートで再帰的にソートする。

- **結合:** 必要ない。既にソートされている。

手続きを示す。

```pseudo
QUICKSORT(A, p, r)
  if p < r
    q = PARTITION(A, p, r)
    QUICKSORT(A, p, q - 1)
    QUICKSORT(A, q + 1, r)
```

```pseudo
PARTITION(A, p, r):
  x = A[r]
  i = p - 1
  for j = p to r - 1
    if A[j] <= x
      i = i + 1
      A[i] を A[j] と交換する
  A[i + 1] を A[r] と交換する
  return i + 1
```

$x = A[r]$ を**ピボット**(pivot)という。

[← 前へ](../ch06/note.md)
